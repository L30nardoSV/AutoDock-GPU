language: cpp

services:
- docker

jobs:
  include:
  - os: linux
    dist: focal
    sudo: required
    env: NUMWI=1
  - os: linux
    dist: focal
    sudo: required
    env: NUMWI=4
  - os: linux
    dist: focal
    sudo: required
    env: NUMWI=8
  - os: linux
    dist: focal
    sudo: required
    env: NUMWI=16
  - os: linux
    dist: bionic
    sudo: required
    env: NUMWI=16
  - os: linux
    dist: xenial
    sudo: required
    env: NUMWI=16

before_install:
- export GIT_BRANCH=docker
- export GIT_SLUG=L30nardoSV/AutoDock-GPU
- docker build --build-arg git_branch=${GIT_BRANCH} --build-arg git_slug=${GIT_SLUG} -t adgpu .

script:
- export numwi=${NUMWI}
- docker run -e numwi adgpu
